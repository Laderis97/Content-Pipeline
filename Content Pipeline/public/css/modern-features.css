/* Modern CSS Features - Content Pipeline System (2025) */
/* Container Queries, Subgrid, Cascade Layers, and more */

/* ===== CASCADE LAYERS ===== */
@layer reset, base, components, utilities;

/* ===== RESET LAYER ===== */
@layer reset {
  *, *::before, *::after {
    box-sizing: border-box;
  }

  * {
    margin: 0;
  }

  html, body {
    height: 100%;
  }

  body {
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
  }

  img, picture, video, canvas, svg {
    display: block;
    max-width: 100%;
  }

  input, button, textarea, select {
    font: inherit;
  }

  p, h1, h2, h3, h4, h5, h6 {
    overflow-wrap: break-word;
  }

  #root, #__next {
    isolation: isolate;
  }
}

/* ===== BASE LAYER ===== */
@layer base {
  html {
    font-family: var(--font-sans);
    font-size: 16px;
  }

  body {
    background-color: var(--color-bg);
    color: var(--color-text);
    font-size: var(--text-base);
    line-height: var(--leading-normal);
  }

  h1, h2, h3, h4, h5, h6 {
    font-weight: var(--font-bold);
    line-height: var(--leading-tight);
    color: var(--color-text);
  }

  h1 { font-size: var(--text-4xl); }
  h2 { font-size: var(--text-3xl); }
  h3 { font-size: var(--text-2xl); }
  h4 { font-size: var(--text-xl); }
  h5 { font-size: var(--text-lg); }
  h6 { font-size: var(--text-base); }

  a {
    color: var(--color-primary);
    text-decoration: none;
    transition: var(--transition-all);
  }

  a:hover {
    color: var(--color-primary-hover);
  }

  button {
    cursor: pointer;
    border: none;
    background: none;
    font: inherit;
  }

  /* Focus styles for accessibility */
  :focus-visible {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
  }

  /* Reduced motion support */
  @media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }
}

/* ===== COMPONENTS LAYER ===== */
@layer components {
  /* Button Components */
  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-4);
    border: 1px solid transparent;
    border-radius: var(--radius-md);
    font-family: var(--font-sans);
    font-size: var(--text-sm);
    font-weight: var(--font-medium);
    line-height: var(--leading-tight);
    text-decoration: none;
    cursor: pointer;
    transition: var(--transition-all);
    position: relative;
    overflow: hidden;
  }

  .btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    pointer-events: none;
  }

  .btn--primary {
    background: var(--color-primary);
    color: var(--color-text-inverse);
    border-color: var(--color-primary);
  }

  .btn--primary:hover {
    background: var(--color-primary-hover);
    border-color: var(--color-primary-hover);
    transform: translateY(-1px);
    box-shadow: var(--shadow-md);
  }

  .btn--primary:active {
    background: var(--color-primary-active);
    transform: translateY(0);
  }

  .btn--secondary {
    background: transparent;
    color: var(--color-primary);
    border-color: var(--color-primary);
  }

  .btn--secondary:hover {
    background: var(--color-primary);
    color: var(--color-text-inverse);
  }

  .btn--ghost {
    background: transparent;
    color: var(--color-text);
    border-color: var(--color-border);
  }

  .btn--ghost:hover {
    background: var(--color-surface);
    border-color: var(--color-border-strong);
  }

  .btn--sm {
    padding: var(--space-1) var(--space-3);
    font-size: var(--text-xs);
  }

  .btn--lg {
    padding: var(--space-3) var(--space-6);
    font-size: var(--text-lg);
  }

  /* Card Components */
  .card {
    background: var(--color-surface-elevated);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-6);
    box-shadow: var(--shadow-sm);
    transition: var(--transition-all);
  }

  .card:hover {
    box-shadow: var(--shadow-md);
    transform: translateY(-2px);
  }

  .card--elevated {
    box-shadow: var(--shadow-lg);
  }

  .card--interactive {
    cursor: pointer;
  }

  .card--interactive:hover {
    box-shadow: var(--shadow-xl);
    transform: translateY(-4px);
  }

  /* Form Components */
  .form-group {
    margin-bottom: var(--space-4);
  }

  .form-label {
    display: block;
    font-weight: var(--font-medium);
    margin-bottom: var(--space-1);
    color: var(--color-text);
  }

  .form-input {
    width: 100%;
    padding: var(--space-2) var(--space-3);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    font-family: var(--font-sans);
    font-size: var(--text-sm);
    background: var(--color-surface);
    color: var(--color-text);
    transition: var(--transition-all);
  }

  .form-input:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px var(--color-primary-light);
  }

  .form-input:invalid {
    border-color: var(--color-error);
  }

  .form-error {
    color: var(--color-error);
    font-size: var(--text-xs);
    margin-top: var(--space-1);
  }

  /* Navigation Components */
  .nav {
    display: flex;
    gap: var(--space-4);
    align-items: center;
  }

  .nav--vertical {
    flex-direction: column;
    align-items: stretch;
  }

  .nav-link {
    padding: var(--space-2) var(--space-3);
    border-radius: var(--radius-md);
    transition: var(--transition-all);
  }

  .nav-link:hover {
    background: var(--color-surface);
  }

  .nav-link--active {
    background: var(--color-primary);
    color: var(--color-text-inverse);
  }

  /* Status Components */
  .status {
    display: inline-flex;
    align-items: center;
    gap: var(--space-1);
    padding: var(--space-1) var(--space-2);
    border-radius: var(--radius-full);
    font-size: var(--text-xs);
    font-weight: var(--font-medium);
  }

  .status--success {
    background: var(--color-success-light);
    color: var(--color-success);
  }

  .status--warning {
    background: var(--color-warning-light);
    color: var(--color-warning);
  }

  .status--error {
    background: var(--color-error-light);
    color: var(--color-error);
  }

  .status--info {
    background: var(--color-info-light);
    color: var(--color-info);
  }
}

/* ===== UTILITIES LAYER ===== */
@layer utilities {
  /* Display Utilities */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  .skip-link {
    position: absolute;
    top: -40px;
    left: var(--space-2);
    background: var(--color-primary);
    color: var(--color-text-inverse);
    padding: var(--space-2);
    text-decoration: none;
    border-radius: var(--radius-md);
    z-index: var(--z-tooltip);
    font-weight: var(--font-bold);
  }

  .skip-link:focus {
    top: var(--space-2);
  }

  /* Spacing Utilities */
  .p-0 { padding: var(--space-0); }
  .p-1 { padding: var(--space-1); }
  .p-2 { padding: var(--space-2); }
  .p-3 { padding: var(--space-3); }
  .p-4 { padding: var(--space-4); }
  .p-6 { padding: var(--space-6); }
  .p-8 { padding: var(--space-8); }

  .m-0 { margin: var(--space-0); }
  .m-1 { margin: var(--space-1); }
  .m-2 { margin: var(--space-2); }
  .m-3 { margin: var(--space-3); }
  .m-4 { margin: var(--space-4); }
  .m-6 { margin: var(--space-6); }
  .m-8 { margin: var(--space-8); }

  /* Text Utilities */
  .text-xs { font-size: var(--text-xs); }
  .text-sm { font-size: var(--text-sm); }
  .text-base { font-size: var(--text-base); }
  .text-lg { font-size: var(--text-lg); }
  .text-xl { font-size: var(--text-xl); }
  .text-2xl { font-size: var(--text-2xl); }
  .text-3xl { font-size: var(--text-3xl); }
  .text-4xl { font-size: var(--text-4xl); }

  .font-thin { font-weight: var(--font-thin); }
  .font-light { font-weight: var(--font-light); }
  .font-normal { font-weight: var(--font-normal); }
  .font-medium { font-weight: var(--font-medium); }
  .font-semibold { font-weight: var(--font-semibold); }
  .font-bold { font-weight: var(--font-bold); }

  .text-center { text-align: center; }
  .text-left { text-align: left; }
  .text-right { text-align: right; }

  /* Color Utilities */
  .text-primary { color: var(--color-primary); }
  .text-secondary { color: var(--color-text-secondary); }
  .text-muted { color: var(--color-text-muted); }
  .text-success { color: var(--color-success); }
  .text-warning { color: var(--color-warning); }
  .text-error { color: var(--color-error); }

  .bg-primary { background-color: var(--color-primary); }
  .bg-surface { background-color: var(--color-surface); }
  .bg-surface-elevated { background-color: var(--color-surface-elevated); }

  /* Border Utilities */
  .border { border: 1px solid var(--color-border); }
  .border-strong { border: 1px solid var(--color-border-strong); }
  .border-primary { border: 1px solid var(--color-primary); }

  .rounded { border-radius: var(--radius-md); }
  .rounded-lg { border-radius: var(--radius-lg); }
  .rounded-xl { border-radius: var(--radius-xl); }
  .rounded-full { border-radius: var(--radius-full); }

  /* Shadow Utilities */
  .shadow-sm { box-shadow: var(--shadow-sm); }
  .shadow-md { box-shadow: var(--shadow-md); }
  .shadow-lg { box-shadow: var(--shadow-lg); }
  .shadow-xl { box-shadow: var(--shadow-xl); }

  /* Animation Utilities */
  .animate-fade-in {
    animation: fadeIn 0.3s ease-in-out;
  }

  .animate-slide-up {
    animation: slideUp 0.3s ease-out;
  }

  .animate-bounce {
    animation: bounce 1s infinite;
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes slideUp {
    from { 
      opacity: 0;
      transform: translateY(20px);
    }
    to { 
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes bounce {
    0%, 20%, 53%, 80%, 100% {
      animation-timing-function: cubic-bezier(0.215, 0.610, 0.355, 1.000);
      transform: translate3d(0,0,0);
    }
    40%, 43% {
      animation-timing-function: cubic-bezier(0.755, 0.050, 0.855, 0.060);
      transform: translate3d(0, -30px, 0);
    }
    70% {
      animation-timing-function: cubic-bezier(0.755, 0.050, 0.855, 0.060);
      transform: translate3d(0, -15px, 0);
    }
    90% {
      transform: translate3d(0,-4px,0);
    }
  }
}
